<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Menezes Barbearia</title>

<link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700;900&family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">

<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

<style>
body{
    margin:0;
    font-family:'Poppins', sans-serif;
    background:#0d0d0d;
    color:white;
}

.hero{
    height:90vh;
    background:linear-gradient(rgba(0,0,0,0.8), rgba(0,0,0,0.9)),
    url('https://images.unsplash.com/photo-1585747860715-2ba37e788b70?auto=format&fit=crop&w=1500&q=80');
    background-size:cover;
    background-position:center;
    display:flex;
    flex-direction:column;
    justify-content:center;
    align-items:center;
    text-align:center;
    padding:20px;
}

.hero h1{
    font-family:'Playfair Display', serif;
    font-size:48px;
    color:#d4af37;
}

.hero h2{
    font-weight:300;
}

.section{
    padding:60px 20px;
    text-align:center;
}

.section h3{
    font-family:'Playfair Display', serif;
    font-size:32px;
    color:#d4af37;
}

form{
    max-width:400px;
    margin:30px auto;
    display:flex;
    flex-direction:column;
    gap:15px;
}

input, select{
    padding:12px;
    border-radius:8px;
    border:1px solid #d4af37;
    background:#1a1a1a;
    color:white;
}

button{
    background:#d4af37;
    border:none;
    padding:14px;
    border-radius:30px;
    font-weight:600;
    cursor:pointer;
    transition:0.3s;
}

button:hover{
    background:white;
}

.msg{
    margin-top:15px;
    font-weight:600;
}
</style>
</head>

<body>

<div class="hero">
    <h1>MENEZES BARBEARIA</h1>
    <h2>Corte de respeito. Estilo que impõe presença.</h2>
</div>

<div class="section">
    <h3>Agende seu horário</h3>

    <form id="form">
        <input type="text" id="nome" placeholder="Seu nome" required>
        <input type="text" id="telefone" placeholder="Seu telefone" required>

        <select id="servico" required>
            <option value="">Escolha o serviço</option>
            <option>Corte</option>
            <option>Barba</option>
            <option>Sobrancelha</option>
        </select>

        <input type="date" id="data" required>
        <input type="time" id="horario" min="08:00" max="15:30" required>

        <button type="submit">CONFIRMAR AGENDAMENTO</button>
        <div class="msg" id="msg"></div>
    </form>
</div>

<script>
const supabase = supabase.createClient(
  "https://vmtizubcbzcscvrjnbkc.supabase.co",
  "sb_publishable_yTBSdMmjv1qIH8V9FViobw_DBIwtm_D"
);

const form = document.getElementById("form");
const msg = document.getElementById("msg");

form.addEventListener("submit", async (e) => {
    e.preventDefault();

    const nome = document.getElementById("nome").value;
    const telefone = document.getElementById("telefone").value;
    const servico = document.getElementById("servico").value;
    const data = document.getElementById("data").value;
    const horario = document.getElementById("horario").value;

    // Verifica se horário já existe
    const { data: existente } = await supabase
        .from("agendamentos")
        .select("*")
        .eq("data", data)
        .eq("horario", horario);

    if (existente.length > 0) {
        msg.style.color = "red";
        msg.innerText = "⚠️ Esse horário já está reservado.";
        return;
    }

    const { error } = await supabase
        .from("agendamentos")
        .insert([{ nome, telefone, servico, data, horario }]);

    if (error) {
        msg.style.color = "red";
        msg.innerText = "Erro ao agendar.";
    } else {
        msg.style.color = "#d4af37";
        msg.innerText = "✅ Horário agendado com sucesso!";
        form.reset();
    }
});
</script>

</body>
</html>
