<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Menezes Barbearia</title>

<link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@600;800&family=Montserrat:wght@300;500;700&display=swap" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

<style>
body{margin:0;background:#0a0a0a;font-family:'Montserrat';color:#fff}
.hero{
height:70vh;
background:linear-gradient(rgba(0,0,0,.8),rgba(0,0,0,.9)),
url('https://images.unsplash.com/photo-1599351431202-1e0f0137899a?auto=format&fit=crop&w=1600&q=80');
background-size:cover;
background-position:center;
display:flex;
justify-content:center;
align-items:center;
flex-direction:column;
text-align:center;
}
.hero h1{font-family:'Cinzel';font-size:50px;color:#d4af37}
.container{max-width:1000px;margin:auto;padding:30px}
.grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(150px,1fr));gap:15px}
.card{background:#111;border:1px solid #d4af37;padding:15px;border-radius:10px;cursor:pointer;text-align:center}
.card:hover{background:#d4af37;color:#000}
.selected{background:#d4af37;color:#000}
input,button{width:100%;padding:12px;margin-top:10px;border-radius:8px;border:none}
button{background:#d4af37;font-weight:bold;cursor:pointer}
</style>
</head>
<body>

<div class="hero">
<h1>MENEZES BARBEARIA</h1>
</div>

<div class="container">

<h2>Serviços</h2>
<div id="servicos" class="grid"></div>

<h2>Datas</h2>
<div id="datas" class="grid"></div>

<h2>Horários</h2>
<div id="horarios" class="grid"></div>

<h2>Seus Dados</h2>
<input id="nome" placeholder="Nome e Sobrenome">
<input id="telefone" placeholder="Telefone">
<button onclick="agendar()">Confirmar</button>

</div>

<script>
const supabase = window.supabase.createClient(
"https://vmtizubcbzcscvrjnbkc.supabase.co",
"sb_publishable_yTBSdMmjv1qIH8V9FViobw_DBIwtm_D"
);

const servicos=["Corte","Barba","Sobrancelha","Pezinho","Corte + Sobrancelha","Corte + Barba","Corte + Barba + Sobrancelha","Sidcut"];
let servicoSel=null,dataSel=null,horaSel=null;

function gerarServicos(){
const div=document.getElementById("servicos");
servicos.forEach(s=>{
let c=document.createElement("div");
c.className="card";
c.innerText=s;
c.onclick=()=>{
document.querySelectorAll("#servicos .card").forEach(x=>x.classList.remove("selected"));
c.classList.add("selected");
servicoSel=s;
};
div.appendChild(c);
});
}

function gerarDatas(){
let hoje=new Date();
const div=document.getElementById("datas");
for(let i=0;i<10;i++){
let d=new Date();
d.setDate(hoje.getDate()+i);
if(d.getDay()>=1 && d.getDay()<=6){
let c=document.createElement("div");
c.className="card";
c.innerText=d.toLocaleDateString("pt-BR",{weekday:'long',day:'2-digit',month:'2-digit'});
c.onclick=()=>{
document.querySelectorAll("#datas .card").forEach(x=>x.classList.remove("selected"));
c.classList.add("selected");
dataSel=d.toISOString().split('T')[0];
gerarHorarios();
};
div.appendChild(c);
}
}
}

async function gerarHorarios(){
const div=document.getElementById("horarios");
div.innerHTML="";
for(let h=8;h<=15;h++){
for(let m of ["00","30"]){
let hora=`${h}:${m}`;
let {data}=await supabase.from("agendamentos").select("*").eq("data",dataSel).eq("hora",hora);
if(data.length===0){
let c=document.createElement("div");
c.className="card";
c.innerText=hora;
c.onclick=()=>{
document.querySelectorAll("#horarios .card").forEach(x=>x.classList.remove("selected"));
c.classList.add("selected");
horaSel=hora;
};
div.appendChild(c);
}
}
}
}

async function agendar(){
let nome=document.getElementById("nome").value;
if(!nome.includes(" ")){alert("Digite nome e sobrenome");return;}
await supabase.from("agendamentos").insert([{nome,servico:servicoSel,data:dataSel,hora:horaSel}]);
alert("Agendado!");
gerarHorarios();
}

gerarServicos();
gerarDatas();
</script>

</body>
</html>
